version: 2.1
jobs:
    update_kubernetes:
        docker:
            - image: sennerholm/google-cloud-sdk-terraform
        steps:
            - checkout
            - run: 
                name: Google Authenticate
                command: "echo ${GOOGLE_AUTH} | base64 -i --decode > gcp-key.json ; gcloud auth activate-service-account --key-file gcp-key.json"
            - run: 
                name: Update kubernetes
                working_directory: gce_multiple/extras/
                command: ./planverifyapply.sh common/kubernetes

# Orchestrate or schedule a set of jobs
workflows:
    update_google:
        jobs:
            - update_kubernetes
